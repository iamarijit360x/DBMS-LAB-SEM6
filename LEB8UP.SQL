CREATE TABLE SALESPEOPLEX(SNUM VARCHAR2(5) PRIMARY KEY,SNAME VARCHAR2(20),CITY VARCHAR2(20),COMM NUMBER(4));
CREATE TABLE CUSTOMERX(CNUM VARCHAR2(5) PRIMARY KEY,CNAME VARCHAR2(20),CITY VARCHAR2(20),RATTING NUMBER(2),SNUM VARCHAR2(5) REFERENCES SALESPEOPLEX(SNUM));
CREATE TABLE ORDERSX(ONUM VARCHAR2(5) PRIMARY KEY,AMT NUMBER(5),ODATE DATE,CNUM VARCHAR2(20) REFERENCES CUSTOMERX(CNUM),SNUM VARCHAR2(5) REFERENCES SALESPEOPLEX(SNUM));

INSERT ALL
    INTO SALESPEOPLEX VALUES('S0001','Arijit','Haripal',1200)
    INTO SALESPEOPLEX VALUES('S0002','Arnab','BudgeBudge',3000)
    INTO SALESPEOPLEX VALUES('S0003','Aditi','Joka',2300)
    INTO SALESPEOPLEX VALUES('S0004','Triasa','Howrah',1730)
    INTO SALESPEOPLEX VALUES('S0005','Madhurima','Howrah',2321)
    INTO SALESPEOPLEX VALUES('S0006','Sumedha','Behala',1030)
    INTO SALESPEOPLEX VALUES('S0007','Ankita','Behala',2321)
SELECT * FROM DUAL;

INSERT ALL
    INTO CUSTOMERX VALUES('C0001','Aviree','Dumdum',10,'S0001')
    INTO CUSTOMERX VALUES('C0002','Shounak','Behala',6,'S0003')
    INTO CUSTOMERX VALUES('C0003','Tiyasha','Behala',5,'S0002')
    INTO CUSTOMERX VALUES('C0004','Kaustav','Haripal',10,'S0004')
    INTO CUSTOMERX VALUES('C0005','Rupam','Singur',7,'S0001')
    INTO CUSTOMERX VALUES('C0006','Subham','Kolaghat',10,'S0005')
    INTO CUSTOMERX VALUES('C0007','Aniket','Garia',8,'S0004')
    INTO CUSTOMERX VALUES('C0008','Taniya','Singur',5,'S0003')
SELECT * FROM DUAL;

INSERT ALL
    INTO ORDERSX VALUES('O0001',200,'21-OCT-2000','C0001','S0001')
    INTO ORDERSX VALUES('O0002',153,'1-JAN-2000','C0002','S0003')
    INTO ORDERSX VALUES('O0003',34,'31-AUG-2000','C0003','S0002')
    INTO ORDERSX VALUES('O0004',79,'18-SEP-2000','C0004','S0004')
    INTO ORDERSX VALUES('O0005',69,'7-JUN-2000','C0005','S0001')
    INTO ORDERSX VALUES('O0006',92,'13-JULY-2000','C0006','S0005')
    INTO ORDERSX VALUES('O0007',120,'21-OCT-2000','C0007','S0004')
    INTO ORDERSX VALUES('O0008',58,'5-DEC-2000','C0008','S0003')
SELECT * FROM DUAL;

CREATE VIEW HIGHESTRATT AS SELECT CNAME FROM CUSTOMERX WHERE RATTING=(SELECT MAX(RATTING) FROM CUSTOMERX);
CREATE VIEW NUMOFSALP AS SELECT CITY,COUNT(SNUM) AS TOTAL_SALESPEOPLE FROM SALESPEOPLEX GROUP BY CITY;
CREATE VIEW TOTALORD AS SELECT SNUM,COUNT(ONUM) AS TOTALORDERS FROM ORDERSX GROUP BY SNUM;
CREATE VIEW AVGORD AS SELECT AVG(COUNT(ONUM)) AS AVERAGE_ORDERS FROM ORDERSX GROUP BY SNUM;
CREATE VIEW MULTICUST AS SELECT SNAME FROM SALESPEOPLEX WHERE SNUM IN (SELECT SNUM FROM CUSTOMERX GROUP BY SNUM HAVING COUNT(CNUM)>1);

CREATE VIEW Salespeople_Customer AS 
SELECT SALESPEOPLEX.SNAME,CUSTOMERX.CNAME,ORDERSX.ONUM
FROM SALESPEOPLEX,CUSTOMERX,ORDERSX
WHERE SALESPEOPLEX.SNUM=ORDERSX.SNUM AND CUSTOMERX.CNUM=ORDERSX.CNUM;  

DROP VIEW VIEW_SALESPERSONX;
CREATE VIEW VIEW_SALESPERSONX AS
SELECT SNUM,COMM FROM SALESPEOPLEX
WHERE COMM BETWEEN 1000 AND 2000 ;
